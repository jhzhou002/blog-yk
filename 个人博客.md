# 个人博客

## 一、项目概述

### 1.1 项目目标

开发一个响应式博客网站，支持 PC 端与移动端访问，提供文章展示、分类管理、标签管理、评论系统、用户注册/登录、全文搜索、热门文章推荐等功能。
 网站需支持媒体资源（图片、附件）存储至 **七牛云对象存储**，并通过 **宝塔面板** 部署上线。

### 1.2 技术栈

- **前端**：Bootstrap 5 + 自定义 CSS/JS
- **后端**：Django 4.x（MVC 模式）
- **数据库**：MySQL 8.x
- **对象存储**：七牛云（存储图片、附件）
- **部署环境**：宝塔面板（Nginx + Gunicorn + Supervisor）
- **其他**：Redis（缓存和会话存储，可选）

------

## 二、功能需求

### 2.1 用户端功能

1. **首页文章展示**
   - 按发布时间倒序显示
   - 文章缩略图、标题、摘要、发布时间、分类、标签、作者信息
   - 分页加载
2. **文章详情页**
   - 正文内容（支持 Markdown/富文本）
   - 图片/视频显示（七牛云直链）
   - 阅读量统计
   - 标签、分类展示
   - 上一篇/下一篇导航
3. **分类与标签页**
   - 分类页：按分类展示文章
   - 标签页：按标签展示文章
4. **搜索功能**
   - 按标题、摘要、正文全文搜索
5. **热门文章推荐**
   - 按阅读量或评论数排行
6. **评论系统**
   - 支持登录用户评论
   - 评论审核机制（后台可开启/关闭）
7. **用户账户**
   - 注册、登录、登出
   - 修改个人信息、密码
8. **响应式设计**
   - 移动端优先布局
   - 自适应导航、列表、表格

### 2.2 管理端功能

1. **文章管理**
   - 新增、编辑、删除文章
   - 设置封面图（上传到七牛云）
   - 文章草稿与发布
2. **分类管理**
   - 新增、编辑、删除分类
3. **标签管理**
   - 新增、编辑、删除标签
4. **评论管理**
   - 审核、删除评论
5. **用户管理**
   - 查看注册用户
   - 封禁/解封用户
6. **系统设置**
   - 七牛云存储配置（Access Key/Secret Key/空间名/域名）
   - 网站基本信息（站点名称、SEO 关键词、描述等）

------

## 三、系统架构

### 3.1 总体架构

```
用户浏览器
   │
   ▼
Bootstrap 前端模板 + JS
   │
   ▼
Django 控制层（View）
   │
   ▼
Django 模型层（Model）
   │
 ┌─MySQL（结构化数据）
 └─七牛云（媒体存储）
```

### 3.2 模块划分

- **blog** 模块：文章、分类、标签、搜索、评论
- **accounts** 模块：用户注册、登录、资料管理
- **common** 模块：公共工具类、配置
- **dashboard** 模块：后台管理

------

## 四、数据库设计（核心表）

### 4.1 用户表（User）

| 字段        | 类型         | 描述              |
| ----------- | ------------ | ----------------- |
| id          | PK, int      | 用户ID            |
| username    | varchar(50)  | 用户名            |
| email       | varchar(100) | 邮箱              |
| password    | varchar(255) | 密码（哈希存储）  |
| avatar      | varchar(255) | 头像URL（七牛云） |
| date_joined | datetime     | 注册时间          |
| is_active   | boolean      | 是否可用          |

### 4.2 文章表（Post）

| 字段         | 类型         | 描述                |
| ------------ | ------------ | ------------------- |
| id           | PK, int      | 文章ID              |
| title        | varchar(255) | 标题                |
| slug         | varchar(255) | URL标识             |
| author_id    | FK(User)     | 作者ID              |
| category_id  | FK(Category) | 分类ID              |
| content      | longtext     | 正文内容            |
| excerpt      | text         | 摘要                |
| cover_image  | varchar(255) | 封面图URL（七牛云） |
| status       | enum         | 草稿/已发布         |
| published_at | datetime     | 发布时间            |
| views        | int          | 阅读量              |
| created_at   | datetime     | 创建时间            |
| updated_at   | datetime     | 更新时间            |

### 4.3 分类表（Category）

| 字段 | 类型         | 描述    |
| ---- | ------------ | ------- |
| id   | PK, int      | 分类ID  |
| name | varchar(100) | 分类名  |
| slug | varchar(100) | URL标识 |

### 4.4 标签表（Tag）

| 字段 | 类型        | 描述    |
| ---- | ----------- | ------- |
| id   | PK, int     | 标签ID  |
| name | varchar(50) | 标签名  |
| slug | varchar(50) | URL标识 |

### 4.5 评论表（Comment）

| 字段        | 类型     | 描述             |
| ----------- | -------- | ---------------- |
| id          | PK, int  | 评论ID           |
| post_id     | FK(Post) | 文章ID           |
| user_id     | FK(User) | 用户ID（可空）   |
| content     | text     | 评论内容         |
| parent_id   | int      | 父评论ID（可空） |
| is_approved | boolean  | 是否通过审核     |
| created_at  | datetime | 创建时间         |

数据库配置信息：

```
host:101.35.218.174

username:tongyong

pwd:zhjh0704

database:blog_test
```

------

## 五、前端设计

### 5.1 设计原则

- 移动端优先（Mobile First）
- 响应式布局（Bootstrap 栅格系统）
- 保持简洁，突出内容

### 5.2 样式与组件

- **导航栏**：自适应折叠，移动端使用汉堡菜单
- **文章列表**：卡片布局（封面图+摘要+meta信息）
- **侧边栏**（PC端显示，移动端折叠）：热门文章、分类、标签
- **分页**：Bootstrap 分页组件
- **表单**：Bootstrap 表单组，支持移动端优化输入体验

------

## 六、核心业务流程

1. **文章发布流程**
   - 管理员/作者登录后台 → 新建文章 → 上传封面图到七牛云 → 保存至数据库 → 前台展示
2. **用户注册/登录流程**
   - 用户填写注册表单 → 后端验证 → 数据库存储 → 自动登录或跳转到登录页
3. **评论发布流程**
   - 登录用户提交评论 → 后端验证 → 存储数据库 → 后台审核后显示
4. **媒体文件上传流程**
   - 用户在后台选择文件 → 前端直传至七牛云 → 返回 URL 存数据库 → 页面引用 URL

------

## 七、七牛云存储集成

### 7.1 存储内容

- 文章封面图
- 富文本/Markdown中的图片
- 用户头像

### 7.2 集成方式

- 使用 Django 第三方库 `django-qiniu-storage` 或 API SDK
- 直传方案：前端获取上传凭证 → JS 上传至七牛云 → 回调返回文件URL

七牛云配置：

```
AK：nfxmZVGEHjkd8Rsn44S-JSynTBUUguTScil9dDvC
SK：9lZjiRtRLL0U_MuYkcUZBAL16TlIJ8_dDSbTqqU2
空间名称：youxuan-images
存储文件夹：blog-yk（文章图片存到该文件夹下的images文件夹下，头像存到avatar文件夹下）
存储区域：华东-浙江
注意：存储的图片要进行重命名后存储，以合适的规则进行命名
```



------

## 八、安全与性能

1. **安全**
   - HTTPS（宝塔+Let’s Encrypt）
   - CSRF 防护（Django内置）
   - XSS 防护（模板转义）
   - 密码加密（Django默认PBKDF2）
   - 限制上传文件类型和大小
2. **性能**
   - Redis 缓存热门文章
   - 数据库索引优化（slug, category_id, published_at）
   - 压缩图片（七牛云处理样式）

